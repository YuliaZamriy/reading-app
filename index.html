<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spelling Toots!</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', 'Chalkboard', cursive, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 30px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        h2 {
            text-align: center;
            color: #666;
            font-size: 1.5em;
            margin-bottom: 20px;
        }

        .stars-display {
            text-align: center;
            font-size: 1.5em;
            margin-bottom: 20px;
        }

        /* Main Menu */
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .menu-btn {
            padding: 25px 20px;
            font-size: 1.3em;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .menu-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .menu-btn .emoji {
            font-size: 2.5em;
        }

        .btn-sight { background: linear-gradient(135deg, #FF6B6B, #FF8E8E); color: white; }
        .btn-spell { background: linear-gradient(135deg, #4ECDC4, #6EE7DE); color: white; }
        .btn-write { background: linear-gradient(135deg, #FFE66D, #FFF19E); color: #333; }
        .btn-match { background: linear-gradient(135deg, #95E1D3, #B5F1E5); color: #333; }
        .btn-sentence { background: linear-gradient(135deg, #DDA0DD, #EEC0EE); color: #333; }
        .btn-vocab { background: linear-gradient(135deg, #87CEEB, #B0E2FF); color: #333; }

        /* Game Screens */
        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        .back-btn {
            background: #666;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2em;
            border-radius: 15px;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .back-btn:hover {
            background: #888;
        }

        /* Common Game Elements */
        .game-word {
            font-size: 4em;
            text-align: center;
            padding: 30px;
            margin: 20px 0;
            background: #f0f0f0;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .game-word:hover {
            background: #e0e0e0;
            transform: scale(1.02);
        }

        .game-sentence {
            font-size: 1.5em;
            text-align: center;
            color: #666;
            font-style: italic;
            margin: 10px 0 20px;
        }

        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .game-btn {
            padding: 15px 35px;
            font-size: 1.3em;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .game-btn:hover {
            transform: scale(1.05);
        }

        .btn-primary { background: #4ECDC4; color: white; }
        .btn-secondary { background: #FFE66D; color: #333; }
        .btn-success { background: #95E1D3; color: #333; }

        /* Spelling Mode */
        .spell-input {
            width: 100%;
            max-width: 400px;
            padding: 20px;
            font-size: 2em;
            text-align: center;
            border: 4px solid #4ECDC4;
            border-radius: 15px;
            margin: 20px auto;
            display: block;
        }

        .spell-input:focus {
            outline: none;
            border-color: #FF6B6B;
        }

        .feedback {
            text-align: center;
            font-size: 2em;
            padding: 20px;
            margin: 20px 0;
            border-radius: 15px;
        }

        .feedback.correct {
            background: #95E1D3;
            color: #155724;
        }

        .feedback.incorrect {
            background: #FFCCCB;
            color: #721c24;
        }

        .difficulty-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }

        .diff-btn {
            padding: 10px 25px;
            font-size: 1.1em;
            border: 3px solid #ccc;
            border-radius: 10px;
            cursor: pointer;
            background: white;
        }

        .diff-btn.active {
            border-color: #4ECDC4;
            background: #4ECDC4;
            color: white;
        }

        /* Handwriting Canvas */
        .canvas-container {
            text-align: center;
            margin: 20px 0;
        }

        #writeCanvas {
            border: 4px solid #4ECDC4;
            border-radius: 15px;
            background: white;
            touch-action: none;
            cursor: crosshair;
        }

        .trace-word {
            font-size: 3em;
            text-align: center;
            color: #ddd;
            letter-spacing: 20px;
            margin: 10px 0;
        }

        /* Matching Game */
        .match-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }

        .match-words, .match-pictures {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .match-item {
            padding: 20px;
            font-size: 1.8em;
            text-align: center;
            border: 4px solid #ccc;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
        }

        .match-item:hover {
            border-color: #4ECDC4;
        }

        .match-item.selected {
            border-color: #FF6B6B;
            background: #FFE6E6;
        }

        .match-item.matched {
            opacity: 0.3;
            pointer-events: none;
        }

        /* Sentence Building */
        .sentence-area {
            min-height: 80px;
            border: 4px dashed #ccc;
            border-radius: 15px;
            padding: 15px;
            margin: 20px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            align-items: center;
        }

        .word-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }

        .draggable-word {
            padding: 15px 25px;
            font-size: 1.5em;
            background: #FFE66D;
            border-radius: 10px;
            cursor: pointer;
            user-select: none;
            transition: all 0.2s;
        }

        .draggable-word:hover {
            transform: scale(1.1);
        }

        .draggable-word.in-sentence {
            background: #4ECDC4;
            color: white;
        }

        /* Vocabulary Mode */
        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .category-btn {
            padding: 20px 15px;
            font-size: 1.1em;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.2s;
            background: linear-gradient(135deg, #f0f0f0, #e0e0e0);
        }

        .category-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .vocab-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 10px;
            margin: 20px 0;
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
        }

        .vocab-item {
            padding: 15px;
            text-align: center;
            background: #f9f9f9;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1.1em;
        }

        .vocab-item:hover {
            background: #4ECDC4;
            color: white;
        }

        .vocab-item .item-emoji {
            font-size: 1.8em;
            display: block;
            margin-bottom: 5px;
        }

        /* Fun fact popup */
        .fact-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            z-index: 1000;
            max-width: 400px;
            text-align: center;
            animation: popIn 0.3s ease-out;
        }

        .fact-popup .fact-emoji {
            font-size: 4em;
            margin-bottom: 15px;
        }

        .fact-popup .fact-name {
            font-size: 2em;
            color: #333;
            margin-bottom: 10px;
        }

        .fact-popup .fact-text {
            font-size: 1.3em;
            color: #666;
            line-height: 1.4;
            margin-bottom: 20px;
        }

        .fact-popup button {
            padding: 10px 30px;
            font-size: 1.2em;
            background: #4ECDC4;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
        }

        .fact-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
        }

        @keyframes popIn {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        /* Challenge Mode */
        .challenge-input {
            width: 100%;
            max-width: 300px;
            padding: 15px;
            font-size: 1.5em;
            text-align: center;
            border: 3px solid #4ECDC4;
            border-radius: 10px;
            margin: 10px auto;
            display: block;
        }

        .guessed-words {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }

        .guessed-word {
            padding: 8px 15px;
            background: #95E1D3;
            border-radius: 8px;
            font-size: 1.1em;
        }

        .results-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 8px;
            margin: 20px 0;
        }

        .result-item {
            padding: 10px;
            text-align: center;
            border-radius: 8px;
            font-size: 1em;
        }

        .result-item.got-it {
            background: #95E1D3;
        }

        .result-item.missed {
            background: #FFE66D;
        }

        /* Celebration */
        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 5em;
            animation: celebrate 1s ease-out forwards;
            pointer-events: none;
            z-index: 1000;
        }

        @keyframes celebrate {
            0% { opacity: 1; transform: translate(-50%, -50%) scale(0.5); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
            100% { opacity: 0; transform: translate(-50%, -100%) scale(1); }
        }

        /* Mode selector tabs */
        .mode-tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }

        .mode-tab {
            padding: 10px 20px;
            border: none;
            background: #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
        }

        .mode-tab.active {
            background: #4ECDC4;
            color: white;
        }

        .score-display {
            text-align: center;
            font-size: 1.5em;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Main Menu -->
        <div id="menu" class="screen active">
            <h1>Spelling Toots!</h1>
            <div class="stars-display" id="totalStars">Toots: 0 ğŸ’©</div>
            <div class="menu-grid">
                <button class="menu-btn btn-sight" onclick="showScreen('sight')">
                    <span class="emoji">ğŸ‘€</span>
                    <span>Sight Words</span>
                </button>
                <button class="menu-btn btn-spell" onclick="showScreen('spell')">
                    <span class="emoji">âœï¸</span>
                    <span>Spelling Practice</span>
                </button>
                <button class="menu-btn btn-write" onclick="showScreen('write')">
                    <span class="emoji">ğŸ–Šï¸</span>
                    <span>Handwriting</span>
                </button>
                <button class="menu-btn btn-match" onclick="showScreen('match')">
                    <span class="emoji">ğŸ¯</span>
                    <span>Word Matching</span>
                </button>
                <button class="menu-btn btn-sentence" onclick="showScreen('sentence')">
                    <span class="emoji">ğŸ“</span>
                    <span>Sentence Building</span>
                </button>
                <button class="menu-btn btn-vocab" onclick="showScreen('vocab')">
                    <span class="emoji">ğŸŒ</span>
                    <span>Vocabulary Builder</span>
                </button>
            </div>
        </div>

        <!-- Sight Words Screen -->
        <div id="sight" class="screen">
            <button class="back-btn" onclick="showScreen('menu')">â† Back to Menu</button>
            <h2>Sight Words</h2>
            <div class="mode-tabs">
                <button class="mode-tab active" id="warmupTab" onclick="setSightMode('warmup')">Warm-Up</button>
                <button class="mode-tab" id="advancedTab" onclick="setSightMode('advanced')">Advanced</button>
            </div>
            <p style="text-align:center; color:#666; margin-bottom:10px;">Click the word to hear it!</p>
            <div class="game-word" id="sightWord" onclick="speakWord(this.textContent)">the</div>
            <div class="game-sentence" id="sightSentence"></div>
            <div class="nav-buttons">
                <button class="game-btn btn-secondary" onclick="prevSightWord()">â† Previous</button>
                <button class="game-btn btn-primary" onclick="nextSightWord()">Next â†’</button>
            </div>
            <div id="warmupComplete" style="display:none; text-align:center; margin-top:20px;">
                <button class="game-btn btn-success" onclick="setSightMode('advanced')" style="font-size:1.5em; padding:20px 40px;">
                    Ready for a Challenge? ğŸŒŸ
                </button>
            </div>
        </div>

        <!-- Spelling Screen -->
        <div id="spell" class="screen">
            <button class="back-btn" onclick="showScreen('menu')">â† Back to Menu</button>
            <h2>Spelling Practice</h2>
            <div class="difficulty-selector">
                <button class="diff-btn active" onclick="setDifficulty('easy')">Easy</button>
                <button class="diff-btn" onclick="setDifficulty('medium')">Medium</button>
                <button class="diff-btn" onclick="setDifficulty('hard')">Hard</button>
            </div>
            <div class="score-display" id="spellScore">Correct: 0</div>
            <p style="text-align:center; color:#666;">Listen and type the word!</p>
            <div class="nav-buttons" style="margin-bottom:20px;">
                <button class="game-btn btn-primary" onclick="speakCurrentSpellWord()">ğŸ”Š Hear Word</button>
                <button class="game-btn btn-secondary" onclick="showHint()">ğŸ’¡ Hint</button>
            </div>
            <input type="text" class="spell-input" id="spellInput" placeholder="Type here..." onkeypress="checkSpellEnter(event)">
            <div class="nav-buttons">
                <button class="game-btn btn-success" onclick="checkSpelling()">Check âœ“</button>
            </div>
            <div class="feedback" id="spellFeedback" style="display:none;"></div>
            <div class="nav-buttons" id="spellNextBtn" style="display:none;">
                <button class="game-btn btn-primary" onclick="nextSpellWord()">Next Word â†’</button>
            </div>
        </div>

        <!-- Handwriting Screen -->
        <div id="write" class="screen">
            <button class="back-btn" onclick="showScreen('menu')">â† Back to Menu</button>
            <h2>Handwriting Practice</h2>
            <div class="mode-tabs">
                <button class="mode-tab active" id="freewriteTab" onclick="setWriteMode('free')">Free Write</button>
                <button class="mode-tab" id="traceTab" onclick="setWriteMode('trace')">Trace</button>
            </div>
            <div class="game-word" id="writeWord" onclick="speakWord(this.textContent)" style="font-size:3em;">cat</div>
            <div class="trace-word" id="traceGuide" style="display:none;"></div>
            <div class="canvas-container">
                <canvas id="writeCanvas" width="700" height="200"></canvas>
            </div>
            <div class="nav-buttons">
                <button class="game-btn btn-secondary" onclick="clearCanvas()">Clear</button>
                <button class="game-btn btn-primary" onclick="speakWord(document.getElementById('writeWord').textContent)">ğŸ”Š Hear Word</button>
                <button class="game-btn btn-success" onclick="nextWriteWord()">Next Word â†’</button>
            </div>
        </div>

        <!-- Matching Screen -->
        <div id="match" class="screen">
            <button class="back-btn" onclick="showScreen('menu')">â† Back to Menu</button>
            <h2>Word Matching</h2>
            <p style="text-align:center; color:#666; margin-bottom:20px;">Match the words to the pictures!</p>
            <div class="score-display" id="matchScore">Matches: 0 / 4</div>
            <div class="match-container">
                <div class="match-words" id="matchWords"></div>
                <div class="match-pictures" id="matchPictures"></div>
            </div>
            <div class="nav-buttons">
                <button class="game-btn btn-primary" onclick="newMatchGame()">New Game ğŸ”„</button>
            </div>
        </div>

        <!-- Sentence Building Screen -->
        <div id="sentence" class="screen">
            <button class="back-btn" onclick="showScreen('menu')">â† Back to Menu</button>
            <h2>Sentence Building</h2>
            <p style="text-align:center; color:#666;">Click words to build the sentence!</p>
            <div class="sentence-area" id="sentenceArea">
                <span style="color:#999;">Click words below to add them here</span>
            </div>
            <div class="word-bank" id="wordBank"></div>
            <div class="nav-buttons">
                <button class="game-btn btn-secondary" onclick="clearSentence()">Clear</button>
                <button class="game-btn btn-success" onclick="checkSentence()">Check âœ“</button>
            </div>
            <div class="feedback" id="sentenceFeedback" style="display:none;"></div>
            <div class="nav-buttons" id="sentenceNextBtn" style="display:none;">
                <button class="game-btn btn-primary" onclick="nextSentence()">Next Sentence â†’</button>
            </div>
        </div>

        <!-- Vocabulary Builder Screen -->
        <div id="vocab" class="screen">
            <button class="back-btn" onclick="showScreen('menu')">â† Back to Menu</button>
            <h2>Vocabulary Builder</h2>
            <div class="mode-tabs">
                <button class="mode-tab active" id="learnTab" onclick="setVocabMode('learn')">Learn</button>
                <button class="mode-tab" id="challengeTab" onclick="setVocabMode('challenge')">Challenge</button>
            </div>

            <!-- Category Selection -->
            <div id="categorySelect">
                <p style="text-align:center; color:#666; margin-bottom:15px;">Pick a category:</p>
                <div class="category-grid" id="categoryGrid"></div>
            </div>

            <!-- Learn Mode -->
            <div id="learnMode" style="display:none;">
                <h3 style="text-align:center;" id="learnCategoryTitle"></h3>
                <p style="text-align:center; color:#666;">Click any item to hear it!</p>
                <div class="vocab-list" id="vocabList"></div>
                <div class="nav-buttons">
                    <button class="game-btn btn-secondary" onclick="backToCategories()">â† Categories</button>
                </div>
            </div>

            <!-- Challenge Mode -->
            <div id="challengeMode" style="display:none;">
                <h3 style="text-align:center;" id="challengeCategoryTitle"></h3>
                <p style="text-align:center; color:#666;">Name as many as you can!</p>
                <input type="text" class="challenge-input" id="challengeInput" placeholder="Type and press Enter" onkeypress="checkChallengeEnter(event)">
                <div class="score-display" id="challengeScore">You've named: 0</div>
                <div class="guessed-words" id="guessedWords"></div>
                <div class="nav-buttons">
                    <button class="game-btn btn-secondary" onclick="backToCategories()">â† Categories</button>
                    <button class="game-btn btn-success" onclick="finishChallenge()">Done - Show Results</button>
                </div>
            </div>

            <!-- Results -->
            <div id="resultsMode" style="display:none;">
                <h3 style="text-align:center;" id="resultsTitle"></h3>
                <div class="feedback correct" id="resultsSummary"></div>
                <div class="results-list" id="resultsList"></div>
                <div class="nav-buttons">
                    <button class="game-btn btn-secondary" onclick="backToCategories()">â† Try Another Category</button>
                    <button class="game-btn btn-primary" onclick="retryChallenge()">Try Again ğŸ”„</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============ DATA ============

        // Sight Words
        const warmupWords = [
            'the', 'and', 'a', 'to', 'is', 'in', 'it', 'he', 'she',
            'was', 'for', 'on', 'are', 'you', 'with'
        ];

        const advancedSightWords = [
            { word: 'because', sentence: 'I am happy because it is sunny.' },
            { word: 'thought', sentence: 'She thought about the answer.' },
            { word: 'through', sentence: 'We walked through the park.' },
            { word: 'different', sentence: 'Each snowflake is different.' },
            { word: 'would', sentence: 'I would like some water.' },
            { word: 'could', sentence: 'She could run very fast.' },
            { word: 'should', sentence: 'You should brush your teeth.' },
            { word: 'their', sentence: 'The dogs wagged their tails.' },
            { word: 'there', sentence: 'The book is over there.' },
            { word: 'where', sentence: 'Where is my backpack?' },
            { word: 'which', sentence: 'Which color do you like?' },
            { word: 'before', sentence: 'Wash your hands before eating.' },
            { word: 'after', sentence: 'We play after school.' },
            { word: 'again', sentence: 'Can we play again?' },
            { word: 'always', sentence: 'She always shares her toys.' },
            { word: 'around', sentence: 'The cat ran around the house.' },
            { word: 'another', sentence: 'May I have another cookie?' },
            { word: 'people', sentence: 'Many people live in cities.' },
            { word: 'together', sentence: 'Let us work together.' },
            { word: 'believe', sentence: 'I believe in magic.' },
            { word: 'enough', sentence: 'Do you have enough crayons?' },
            { word: 'question', sentence: 'That is a good question.' },
            { word: 'answer', sentence: 'I know the answer!' },
            { word: 'learn', sentence: 'I love to learn new things.' },
            { word: 'world', sentence: 'The world is very big.' },
            { word: 'important', sentence: 'Reading is important.' },
            { word: 'example', sentence: 'Here is an example.' },
            { word: 'between', sentence: 'Sit between your friends.' },
            { word: 'children', sentence: 'The children played outside.' },
            { word: 'every', sentence: 'I read every day.' }
        ];

        // Spelling Words by Difficulty
        const spellingWords = {
            easy: [
                'cat', 'dog', 'sun', 'hat', 'bed', 'pig', 'cup', 'bat', 'net', 'pen',
                'red', 'big', 'hop', 'sit', 'run', 'fun', 'map', 'wet', 'hot', 'bug'
            ],
            medium: [
                'ship', 'chat', 'thin', 'when', 'bring', 'crash', 'stamp', 'train',
                'black', 'white', 'green', 'sleep', 'dream', 'cream', 'speak', 'beach',
                'chair', 'three', 'wheel', 'think'
            ],
            hard: [
                'make', 'bike', 'home', 'cute', 'whale', 'shake', 'smile', 'wrote',
                'rain', 'boat', 'feet', 'cloud', 'mouse', 'night', 'light', 'caught',
                'brought', 'through', 'enough', 'friend'
            ]
        };

        // Writing Words
        const writeWords = [
            'cat', 'dog', 'sun', 'moon', 'star', 'tree', 'fish', 'bird', 'book', 'ball',
            'house', 'apple', 'happy', 'smile', 'love', 'play', 'read', 'jump', 'swim', 'dance'
        ];

        // Matching Game Items
        const matchItems = [
            { word: 'cat', emoji: 'ğŸ±' },
            { word: 'dog', emoji: 'ğŸ•' },
            { word: 'sun', emoji: 'â˜€ï¸' },
            { word: 'moon', emoji: 'ğŸŒ™' },
            { word: 'star', emoji: 'â­' },
            { word: 'tree', emoji: 'ğŸŒ³' },
            { word: 'fish', emoji: 'ğŸŸ' },
            { word: 'bird', emoji: 'ğŸ¦' },
            { word: 'apple', emoji: 'ğŸ' },
            { word: 'banana', emoji: 'ğŸŒ' },
            { word: 'car', emoji: 'ğŸš—' },
            { word: 'house', emoji: 'ğŸ ' },
            { word: 'book', emoji: 'ğŸ“–' },
            { word: 'heart', emoji: 'â¤ï¸' },
            { word: 'flower', emoji: 'ğŸŒ¸' },
            { word: 'rainbow', emoji: 'ğŸŒˆ' },
            { word: 'butterfly', emoji: 'ğŸ¦‹' },
            { word: 'elephant', emoji: 'ğŸ˜' },
            { word: 'penguin', emoji: 'ğŸ§' },
            { word: 'rocket', emoji: 'ğŸš€' }
        ];

        // Sentences for Building
        const sentences = [
            ['The', 'cat', 'is', 'sleeping', '.'],
            ['I', 'like', 'to', 'read', 'books', '.'],
            ['The', 'sun', 'is', 'very', 'bright', '.'],
            ['She', 'can', 'run', 'fast', '.'],
            ['We', 'went', 'to', 'the', 'park', '.'],
            ['The', 'dog', 'loves', 'to', 'play', '.'],
            ['Birds', 'fly', 'in', 'the', 'sky', '.'],
            ['I', 'eat', 'an', 'apple', 'every', 'day', '.'],
            ['The', 'moon', 'comes', 'out', 'at', 'night', '.'],
            ['My', 'friend', 'is', 'very', 'kind', '.'],
            ['The', 'children', 'are', 'playing', 'together', '.'],
            ['She', 'thought', 'about', 'the', 'question', '.'],
            ['We', 'should', 'always', 'be', 'helpful', '.'],
            ['The', 'butterfly', 'flew', 'through', 'the', 'garden', '.'],
            ['Learning', 'new', 'things', 'is', 'important', '.']
        ];

        // Vocabulary Categories
        const vocabCategories = {
            birds: {
                name: 'Birds',
                emoji: 'ğŸ¦',
                items: [
                    { name: 'robin', emoji: 'ğŸ¦', fact: 'Robins can eat 14 feet of earthworms in a day!' },
                    { name: 'eagle', emoji: 'ğŸ¦…', fact: 'Eagles can see a rabbit from 2 miles away!' },
                    { name: 'owl', emoji: 'ğŸ¦‰', fact: 'Owls can rotate their heads 270 degrees!' },
                    { name: 'penguin', emoji: 'ğŸ§', fact: 'Penguins propose with pebbles!' },
                    { name: 'parrot', emoji: 'ğŸ¦œ', fact: 'Parrots can live up to 80 years!' },
                    { name: 'flamingo', emoji: 'ğŸ¦©', fact: 'Flamingos are pink because of the shrimp they eat!' },
                    { name: 'crow', emoji: 'ğŸ¦â€â¬›', fact: 'Crows can recognize human faces!' },
                    { name: 'duck', emoji: 'ğŸ¦†', fact: 'A duck\'s quack doesn\'t echo!' },
                    { name: 'swan', emoji: 'ğŸ¦¢', fact: 'Swans mate for life!' },
                    { name: 'hawk', emoji: 'ğŸ¦…', fact: 'Hawks can dive at 150 mph!' },
                    { name: 'sparrow', emoji: 'ğŸ¦', fact: 'Sparrows can fly 25 miles per hour!' },
                    { name: 'pigeon', emoji: 'ğŸ•Šï¸', fact: 'Pigeons can find their way home from 1,000 miles away!' },
                    { name: 'peacock', emoji: 'ğŸ¦š', fact: 'A peacock\'s tail has over 200 colorful feathers!' },
                    { name: 'toucan', emoji: 'ğŸ¦', fact: 'A toucan\'s beak is one-third of its body length!' },
                    { name: 'hummingbird', emoji: 'ğŸ¦', fact: 'Hummingbirds can fly backwards!' },
                    { name: 'cardinal', emoji: 'ğŸ¦', fact: 'Cardinals don\'t migrate - they stay all year!' },
                    { name: 'blue jay', emoji: 'ğŸ¦', fact: 'Blue jays can mimic hawk sounds!' },
                    { name: 'woodpecker', emoji: 'ğŸ¦', fact: 'Woodpeckers can peck 20 times per second!' },
                    { name: 'pelican', emoji: 'ğŸ¦', fact: 'A pelican\'s pouch can hold 3 gallons of water!' },
                    { name: 'ostrich', emoji: 'ğŸ¦', fact: 'Ostriches are the fastest birds on land - 45 mph!' },
                    { name: 'chicken', emoji: 'ğŸ”', fact: 'There are more chickens than people on Earth!' },
                    { name: 'turkey', emoji: 'ğŸ¦ƒ', fact: 'Turkeys can see in color!' },
                    { name: 'seagull', emoji: 'ğŸ¦', fact: 'Seagulls can drink salt water!' },
                    { name: 'canary', emoji: 'ğŸ¦', fact: 'Canaries were used in mines to detect gas!' },
                    { name: 'finch', emoji: 'ğŸ¦', fact: 'Finches can have over 10 different songs!' }
                ]
            },
            landAnimals: {
                name: 'Land Animals',
                emoji: 'ğŸ¦',
                items: [
                    { name: 'lion', emoji: 'ğŸ¦', fact: 'A lion\'s roar can be heard from 5 miles away!' },
                    { name: 'tiger', emoji: 'ğŸ¯', fact: 'Every tiger has unique stripes, like fingerprints!' },
                    { name: 'elephant', emoji: 'ğŸ˜', fact: 'Elephants are the only animals that can\'t jump!' },
                    { name: 'giraffe', emoji: 'ğŸ¦’', fact: 'Giraffes only need 30 minutes of sleep a day!' },
                    { name: 'zebra', emoji: 'ğŸ¦“', fact: 'No two zebras have the same stripe pattern!' },
                    { name: 'monkey', emoji: 'ğŸ’', fact: 'Monkeys can count and do simple math!' },
                    { name: 'bear', emoji: 'ğŸ»', fact: 'Bears can run as fast as a horse!' },
                    { name: 'wolf', emoji: 'ğŸº', fact: 'Wolves can eat 20 pounds of meat in one meal!' },
                    { name: 'fox', emoji: 'ğŸ¦Š', fact: 'Foxes use the Earth\'s magnetic field to hunt!' },
                    { name: 'deer', emoji: 'ğŸ¦Œ', fact: 'Deer can jump up to 10 feet high!' },
                    { name: 'rabbit', emoji: 'ğŸ°', fact: 'Rabbits can\'t vomit!' },
                    { name: 'horse', emoji: 'ğŸ´', fact: 'Horses can sleep standing up!' },
                    { name: 'cow', emoji: 'ğŸ„', fact: 'Cows have best friends and get stressed when separated!' },
                    { name: 'pig', emoji: 'ğŸ·', fact: 'Pigs are smarter than dogs!' },
                    { name: 'sheep', emoji: 'ğŸ‘', fact: 'Sheep can remember 50 different faces!' },
                    { name: 'goat', emoji: 'ğŸ', fact: 'Goats have rectangular pupils!' },
                    { name: 'kangaroo', emoji: 'ğŸ¦˜', fact: 'Kangaroos can\'t walk backwards!' },
                    { name: 'koala', emoji: 'ğŸ¨', fact: 'Koalas sleep up to 22 hours a day!' },
                    { name: 'panda', emoji: 'ğŸ¼', fact: 'Pandas spend 12 hours a day eating bamboo!' },
                    { name: 'rhinoceros', emoji: 'ğŸ¦', fact: 'A group of rhinos is called a crash!' },
                    { name: 'hippopotamus', emoji: 'ğŸ¦›', fact: 'Hippos can hold their breath for 5 minutes!' },
                    { name: 'leopard', emoji: 'ğŸ†', fact: 'Leopards can carry prey twice their weight up a tree!' },
                    { name: 'cheetah', emoji: 'ğŸ†', fact: 'Cheetahs can run 70 mph - the fastest land animal!' },
                    { name: 'gorilla', emoji: 'ğŸ¦', fact: 'Gorillas share 98% of their DNA with humans!' },
                    { name: 'camel', emoji: 'ğŸ«', fact: 'Camels can drink 40 gallons of water at once!' }
                ]
            },
            seaAnimals: {
                name: 'Sea Animals',
                emoji: 'ğŸ‹',
                items: [
                    { name: 'shark', emoji: 'ğŸ¦ˆ' },
                    { name: 'whale', emoji: 'ğŸ‹' },
                    { name: 'dolphin', emoji: 'ğŸ¬' },
                    { name: 'octopus', emoji: 'ğŸ™' },
                    { name: 'crab', emoji: 'ğŸ¦€' },
                    { name: 'jellyfish', emoji: 'ğŸª¼' },
                    { name: 'seahorse', emoji: 'ğŸ ' },
                    { name: 'starfish', emoji: 'â­' },
                    { name: 'lobster', emoji: 'ğŸ¦' },
                    { name: 'shrimp', emoji: 'ğŸ¦' },
                    { name: 'seal', emoji: 'ğŸ¦­' },
                    { name: 'turtle', emoji: 'ğŸ¢' },
                    { name: 'clam', emoji: 'ğŸš' },
                    { name: 'squid', emoji: 'ğŸ¦‘' },
                    { name: 'eel', emoji: 'ğŸ' },
                    { name: 'stingray', emoji: 'ğŸ ' },
                    { name: 'salmon', emoji: 'ğŸŸ' },
                    { name: 'tuna', emoji: 'ğŸŸ' },
                    { name: 'goldfish', emoji: 'ğŸ ' },
                    { name: 'clownfish', emoji: 'ğŸ ' }
                ]
            },
            insects: {
                name: 'Insects',
                emoji: 'ğŸ¦‹',
                items: [
                    { name: 'butterfly', emoji: 'ğŸ¦‹' },
                    { name: 'bee', emoji: 'ğŸ' },
                    { name: 'ant', emoji: 'ğŸœ' },
                    { name: 'spider', emoji: 'ğŸ•·ï¸' },
                    { name: 'ladybug', emoji: 'ğŸ' },
                    { name: 'dragonfly', emoji: 'ğŸª°' },
                    { name: 'grasshopper', emoji: 'ğŸ¦—' },
                    { name: 'beetle', emoji: 'ğŸª²' },
                    { name: 'caterpillar', emoji: 'ğŸ›' },
                    { name: 'fly', emoji: 'ğŸª°' },
                    { name: 'mosquito', emoji: 'ğŸ¦Ÿ' },
                    { name: 'cricket', emoji: 'ğŸ¦—' },
                    { name: 'moth', emoji: 'ğŸ¦‹' },
                    { name: 'firefly', emoji: 'âœ¨' },
                    { name: 'cockroach', emoji: 'ğŸª³' },
                    { name: 'wasp', emoji: 'ğŸ' },
                    { name: 'centipede', emoji: 'ğŸ›' },
                    { name: 'scorpion', emoji: 'ğŸ¦‚' },
                    { name: 'snail', emoji: 'ğŸŒ' },
                    { name: 'worm', emoji: 'ğŸª±' }
                ]
            },
            plants: {
                name: 'Plants',
                emoji: 'ğŸŒ»',
                items: [
                    { name: 'rose', emoji: 'ğŸŒ¹' },
                    { name: 'tulip', emoji: 'ğŸŒ·' },
                    { name: 'sunflower', emoji: 'ğŸŒ»' },
                    { name: 'daisy', emoji: 'ğŸŒ¼' },
                    { name: 'oak tree', emoji: 'ğŸŒ³' },
                    { name: 'pine tree', emoji: 'ğŸŒ²' },
                    { name: 'cactus', emoji: 'ğŸŒµ' },
                    { name: 'fern', emoji: 'ğŸŒ¿' },
                    { name: 'grass', emoji: 'ğŸŒ±' },
                    { name: 'bamboo', emoji: 'ğŸ‹' },
                    { name: 'maple tree', emoji: 'ğŸ' },
                    { name: 'palm tree', emoji: 'ğŸŒ´' },
                    { name: 'moss', emoji: 'ğŸŒ¿' },
                    { name: 'vine', emoji: 'ğŸŒ¿' },
                    { name: 'bush', emoji: 'ğŸŒ³' },
                    { name: 'lily', emoji: 'ğŸŒ¸' },
                    { name: 'orchid', emoji: 'ğŸŒº' },
                    { name: 'ivy', emoji: 'ğŸŒ¿' },
                    { name: 'clover', emoji: 'â˜˜ï¸' },
                    { name: 'mushroom', emoji: 'ğŸ„' }
                ]
            },
            fruits: {
                name: 'Fruits',
                emoji: 'ğŸ',
                items: [
                    { name: 'apple', emoji: 'ğŸ', fact: 'Apples float because they are 25% air!' },
                    { name: 'banana', emoji: 'ğŸŒ', fact: 'Bananas are berries, but strawberries aren\'t!' },
                    { name: 'orange', emoji: 'ğŸŠ', fact: 'Oranges are not always orange - they can be green!' },
                    { name: 'grape', emoji: 'ğŸ‡', fact: 'Grapes explode if you put them in the microwave!' },
                    { name: 'strawberry', emoji: 'ğŸ“', fact: 'Strawberries have about 200 seeds on the outside!' },
                    { name: 'watermelon', emoji: 'ğŸ‰', fact: 'Watermelons are 92% water!' },
                    { name: 'mango', emoji: 'ğŸ¥­', fact: 'Mangoes are related to cashews and poison ivy!' },
                    { name: 'peach', emoji: 'ğŸ‘', fact: 'Peaches and almonds are in the same family!' },
                    { name: 'pear', emoji: 'ğŸ', fact: 'Pears ripen better off the tree!' },
                    { name: 'cherry', emoji: 'ğŸ’', fact: 'Cherries are related to roses!' },
                    { name: 'pineapple', emoji: 'ğŸ', fact: 'It takes 2-3 years to grow one pineapple!' },
                    { name: 'lemon', emoji: 'ğŸ‹', fact: 'Lemons contain more sugar than strawberries!' },
                    { name: 'lime', emoji: 'ğŸ‹', fact: 'Limes prevented scurvy for sailors!' },
                    { name: 'coconut', emoji: 'ğŸ¥¥', fact: 'Coconut water can be used as blood plasma!' },
                    { name: 'kiwi', emoji: 'ğŸ¥', fact: 'Kiwis have more vitamin C than oranges!' },
                    { name: 'blueberry', emoji: 'ğŸ«', fact: 'Blueberries are one of the only naturally blue foods!' },
                    { name: 'raspberry', emoji: 'ğŸ‡', fact: 'There are over 200 species of raspberries!' },
                    { name: 'melon', emoji: 'ğŸˆ', fact: 'Melons are related to cucumbers and squash!' },
                    { name: 'plum', emoji: 'ğŸ‘', fact: 'Dried plums are called prunes!' },
                    { name: 'avocado', emoji: 'ğŸ¥‘', fact: 'Avocados are actually fruits, not vegetables!' }
                ]
            },
            vegetables: {
                name: 'Vegetables',
                emoji: 'ğŸ¥•',
                items: [
                    { name: 'carrot', emoji: 'ğŸ¥•' },
                    { name: 'broccoli', emoji: 'ğŸ¥¦' },
                    { name: 'tomato', emoji: 'ğŸ…' },
                    { name: 'potato', emoji: 'ğŸ¥”' },
                    { name: 'cucumber', emoji: 'ğŸ¥’' },
                    { name: 'lettuce', emoji: 'ğŸ¥¬' },
                    { name: 'corn', emoji: 'ğŸŒ½' },
                    { name: 'peas', emoji: 'ğŸŸ¢' },
                    { name: 'onion', emoji: 'ğŸ§…' },
                    { name: 'garlic', emoji: 'ğŸ§„' },
                    { name: 'pepper', emoji: 'ğŸ«‘' },
                    { name: 'spinach', emoji: 'ğŸ¥¬' },
                    { name: 'celery', emoji: 'ğŸ¥¬' },
                    { name: 'beans', emoji: 'ğŸ«˜' },
                    { name: 'cabbage', emoji: 'ğŸ¥¬' },
                    { name: 'cauliflower', emoji: 'ğŸ¥¦' },
                    { name: 'pumpkin', emoji: 'ğŸƒ' },
                    { name: 'zucchini', emoji: 'ğŸ¥’' },
                    { name: 'eggplant', emoji: 'ğŸ†' },
                    { name: 'radish', emoji: 'ğŸ”´' }
                ]
            },
            countries: {
                name: 'Countries',
                emoji: 'ğŸŒ',
                items: [
                    { name: 'United States', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Canada', emoji: 'ğŸ‡¨ğŸ‡¦' },
                    { name: 'Mexico', emoji: 'ğŸ‡²ğŸ‡½' },
                    { name: 'Brazil', emoji: 'ğŸ‡§ğŸ‡·' },
                    { name: 'Argentina', emoji: 'ğŸ‡¦ğŸ‡·' },
                    { name: 'United Kingdom', emoji: 'ğŸ‡¬ğŸ‡§' },
                    { name: 'France', emoji: 'ğŸ‡«ğŸ‡·' },
                    { name: 'Germany', emoji: 'ğŸ‡©ğŸ‡ª' },
                    { name: 'Italy', emoji: 'ğŸ‡®ğŸ‡¹' },
                    { name: 'Spain', emoji: 'ğŸ‡ªğŸ‡¸' },
                    { name: 'China', emoji: 'ğŸ‡¨ğŸ‡³' },
                    { name: 'Japan', emoji: 'ğŸ‡¯ğŸ‡µ' },
                    { name: 'India', emoji: 'ğŸ‡®ğŸ‡³' },
                    { name: 'Australia', emoji: 'ğŸ‡¦ğŸ‡º' },
                    { name: 'Russia', emoji: 'ğŸ‡·ğŸ‡º' },
                    { name: 'Egypt', emoji: 'ğŸ‡ªğŸ‡¬' },
                    { name: 'South Africa', emoji: 'ğŸ‡¿ğŸ‡¦' },
                    { name: 'Kenya', emoji: 'ğŸ‡°ğŸ‡ª' },
                    { name: 'South Korea', emoji: 'ğŸ‡°ğŸ‡·' },
                    { name: 'Thailand', emoji: 'ğŸ‡¹ğŸ‡­' },
                    { name: 'Greece', emoji: 'ğŸ‡¬ğŸ‡·' },
                    { name: 'Sweden', emoji: 'ğŸ‡¸ğŸ‡ª' },
                    { name: 'Norway', emoji: 'ğŸ‡³ğŸ‡´' },
                    { name: 'Ireland', emoji: 'ğŸ‡®ğŸ‡ª' },
                    { name: 'New Zealand', emoji: 'ğŸ‡³ğŸ‡¿' }
                ]
            },
            usStates: {
                name: 'US States',
                emoji: 'ğŸ‡ºğŸ‡¸',
                items: [
                    { name: 'Alabama', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Alaska', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Arizona', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Arkansas', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'California', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Colorado', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Connecticut', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Delaware', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Florida', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Georgia', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Hawaii', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Idaho', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Illinois', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Indiana', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Iowa', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Kansas', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Kentucky', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Louisiana', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Maine', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Maryland', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Massachusetts', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Michigan', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Minnesota', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Mississippi', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Missouri', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Montana', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Nebraska', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Nevada', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'New Hampshire', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'New Jersey', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'New Mexico', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'New York', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'North Carolina', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'North Dakota', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Ohio', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Oklahoma', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Oregon', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Pennsylvania', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Rhode Island', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'South Carolina', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'South Dakota', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Tennessee', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Texas', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Utah', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Vermont', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Virginia', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Washington', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'West Virginia', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Wisconsin', emoji: 'ğŸ‡ºğŸ‡¸' },
                    { name: 'Wyoming', emoji: 'ğŸ‡ºğŸ‡¸' }
                ]
            },
            oceansAndSeas: {
                name: 'Oceans & Seas',
                emoji: 'ğŸŒŠ',
                items: [
                    { name: 'Pacific Ocean', emoji: 'ğŸŒŠ' },
                    { name: 'Atlantic Ocean', emoji: 'ğŸŒŠ' },
                    { name: 'Indian Ocean', emoji: 'ğŸŒŠ' },
                    { name: 'Arctic Ocean', emoji: 'ğŸ§Š' },
                    { name: 'Southern Ocean', emoji: 'ğŸŒŠ' },
                    { name: 'Mediterranean Sea', emoji: 'ğŸŒŠ' },
                    { name: 'Caribbean Sea', emoji: 'ğŸŒ´' },
                    { name: 'Red Sea', emoji: 'ğŸŒŠ' },
                    { name: 'Black Sea', emoji: 'ğŸŒŠ' },
                    { name: 'Baltic Sea', emoji: 'ğŸŒŠ' },
                    { name: 'North Sea', emoji: 'ğŸŒŠ' },
                    { name: 'Coral Sea', emoji: 'ğŸ ' },
                    { name: 'Arabian Sea', emoji: 'ğŸŒŠ' },
                    { name: 'South China Sea', emoji: 'ğŸŒŠ' },
                    { name: 'Gulf of Mexico', emoji: 'ğŸŒŠ' }
                ]
            },
            continents: {
                name: 'Continents',
                emoji: 'ğŸ—ºï¸',
                items: [
                    { name: 'North America', emoji: 'ğŸŒ' },
                    { name: 'South America', emoji: 'ğŸŒ' },
                    { name: 'Europe', emoji: 'ğŸŒ' },
                    { name: 'Asia', emoji: 'ğŸŒ' },
                    { name: 'Africa', emoji: 'ğŸŒ' },
                    { name: 'Australia', emoji: 'ğŸŒ' },
                    { name: 'Antarctica', emoji: 'ğŸ§Š' }
                ]
            },
            planets: {
                name: 'Planets & Space',
                emoji: 'ğŸª',
                items: [
                    { name: 'Mercury', emoji: 'ğŸª¨', fact: 'Mercury is the smallest planet and closest to the Sun!' },
                    { name: 'Venus', emoji: 'ğŸŸ¡', fact: 'Venus spins backwards compared to other planets!' },
                    { name: 'Earth', emoji: 'ğŸŒ', fact: 'Earth is the only planet not named after a god!' },
                    { name: 'Mars', emoji: 'ğŸ”´', fact: 'Mars has the tallest volcano in the solar system!' },
                    { name: 'Jupiter', emoji: 'ğŸŸ¤', fact: 'Jupiter is so big that 1,300 Earths could fit inside!' },
                    { name: 'Saturn', emoji: 'ğŸª', fact: 'Saturn would float if you put it in water!' },
                    { name: 'Uranus', emoji: 'ğŸ”µ', fact: 'Uranus rotates on its side like a rolling ball!' },
                    { name: 'Neptune', emoji: 'ğŸ”µ', fact: 'Neptune has the strongest winds - 1,200 mph!' },
                    { name: 'Pluto', emoji: 'âšª', fact: 'Pluto is smaller than the United States!' },
                    { name: 'Sun', emoji: 'â˜€ï¸', fact: 'The Sun makes up 99.8% of all mass in our solar system!' },
                    { name: 'Moon', emoji: 'ğŸŒ™', fact: 'The Moon is slowly drifting away from Earth!' },
                    { name: 'asteroid', emoji: 'â˜„ï¸', fact: 'There are millions of asteroids in our solar system!' },
                    { name: 'comet', emoji: 'â˜„ï¸', fact: 'Comets are made of ice, dust, and rock - like dirty snowballs!' },
                    { name: 'star', emoji: 'â­', fact: 'There are more stars than grains of sand on Earth!' },
                    { name: 'galaxy', emoji: 'ğŸŒŒ', fact: 'Our galaxy, the Milky Way, has over 100 billion stars!' }
                ]
            },
            bodyParts: {
                name: 'Body Parts',
                emoji: 'ğŸ¦¶',
                items: [
                    { name: 'head', emoji: 'ğŸ—£ï¸' },
                    { name: 'eyes', emoji: 'ğŸ‘€' },
                    { name: 'nose', emoji: 'ğŸ‘ƒ' },
                    { name: 'ears', emoji: 'ğŸ‘‚' },
                    { name: 'mouth', emoji: 'ğŸ‘„' },
                    { name: 'teeth', emoji: 'ğŸ¦·' },
                    { name: 'tongue', emoji: 'ğŸ‘…' },
                    { name: 'arm', emoji: 'ğŸ’ª' },
                    { name: 'hand', emoji: 'âœ‹' },
                    { name: 'fingers', emoji: 'ğŸ–ï¸' },
                    { name: 'leg', emoji: 'ğŸ¦µ' },
                    { name: 'foot', emoji: 'ğŸ¦¶' },
                    { name: 'toes', emoji: 'ğŸ¦¶' },
                    { name: 'knee', emoji: 'ğŸ¦µ' },
                    { name: 'elbow', emoji: 'ğŸ’ª' },
                    { name: 'shoulder', emoji: 'ğŸ¤·' },
                    { name: 'neck', emoji: 'ğŸ—£ï¸' },
                    { name: 'back', emoji: 'ğŸ”™' },
                    { name: 'stomach', emoji: 'ğŸ«ƒ' },
                    { name: 'heart', emoji: 'â¤ï¸' },
                    { name: 'brain', emoji: 'ğŸ§ ' },
                    { name: 'lungs', emoji: 'ğŸ«' },
                    { name: 'bones', emoji: 'ğŸ¦´' },
                    { name: 'skin', emoji: 'ğŸ–ï¸' },
                    { name: 'hair', emoji: 'ğŸ’‡' }
                ]
            },
            colors: {
                name: 'Colors',
                emoji: 'ğŸŒˆ',
                items: [
                    { name: 'red', emoji: 'ğŸ”´' },
                    { name: 'blue', emoji: 'ğŸ”µ' },
                    { name: 'green', emoji: 'ğŸŸ¢' },
                    { name: 'yellow', emoji: 'ğŸŸ¡' },
                    { name: 'orange', emoji: 'ğŸŸ ' },
                    { name: 'purple', emoji: 'ğŸŸ£' },
                    { name: 'pink', emoji: 'ğŸ’—' },
                    { name: 'brown', emoji: 'ğŸŸ¤' },
                    { name: 'black', emoji: 'âš«' },
                    { name: 'white', emoji: 'âšª' },
                    { name: 'gray', emoji: 'ğŸ”˜' },
                    { name: 'turquoise', emoji: 'ğŸ’' },
                    { name: 'magenta', emoji: 'ğŸ’œ' },
                    { name: 'navy', emoji: 'ğŸ”µ' },
                    { name: 'maroon', emoji: 'ğŸ”´' },
                    { name: 'violet', emoji: 'ğŸŸ£' },
                    { name: 'coral', emoji: 'ğŸª¸' },
                    { name: 'gold', emoji: 'ğŸ¥‡' },
                    { name: 'silver', emoji: 'ğŸ¥ˆ' },
                    { name: 'teal', emoji: 'ğŸ’' }
                ]
            },
            vehicles: {
                name: 'Vehicles',
                emoji: 'ğŸš—',
                items: [
                    { name: 'car', emoji: 'ğŸš—' },
                    { name: 'bus', emoji: 'ğŸšŒ' },
                    { name: 'train', emoji: 'ğŸš‚' },
                    { name: 'airplane', emoji: 'âœˆï¸' },
                    { name: 'helicopter', emoji: 'ğŸš' },
                    { name: 'boat', emoji: 'â›µ' },
                    { name: 'ship', emoji: 'ğŸš¢' },
                    { name: 'bicycle', emoji: 'ğŸš²' },
                    { name: 'motorcycle', emoji: 'ğŸï¸' },
                    { name: 'truck', emoji: 'ğŸšš' },
                    { name: 'taxi', emoji: 'ğŸš•' },
                    { name: 'ambulance', emoji: 'ğŸš‘' },
                    { name: 'fire truck', emoji: 'ğŸš’' },
                    { name: 'police car', emoji: 'ğŸš“' },
                    { name: 'rocket', emoji: 'ğŸš€' },
                    { name: 'submarine', emoji: 'ğŸš¤' },
                    { name: 'tractor', emoji: 'ğŸšœ' },
                    { name: 'scooter', emoji: 'ğŸ›´' },
                    { name: 'skateboard', emoji: 'ğŸ›¹' },
                    { name: 'hot air balloon', emoji: 'ğŸˆ' }
                ]
            }
        };

        // ============ STATE ============
        let totalStars = 0;
        let sightMode = 'warmup';
        let sightIndex = 0;
        let spellDifficulty = 'easy';
        let spellIndex = 0;
        let spellCorrect = 0;
        let currentSpellWord = '';
        let writeMode = 'free';
        let writeIndex = 0;
        let matchSelected = null;
        let matchesFound = 0;
        let currentMatchItems = [];
        let sentenceIndex = 0;
        let currentSentenceWords = [];
        let builtSentence = [];
        let vocabMode = 'learn';
        let currentCategory = null;
        let challengeGuesses = [];

        // Shuffled arrays for randomization
        let shuffledWarmupWords = [];
        let shuffledAdvancedWords = [];
        let shuffledSpellWords = { easy: [], medium: [], hard: [] };
        let shuffledWriteWords = [];
        let shuffledSentences = [];

        // Shuffle helper function
        function shuffle(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        // ============ SOUND EFFECTS ============
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playToot() {
            // Resume audio context if suspended (needed for autoplay policies)
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }

            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            // Toot sound - low frequency wobble
            oscillator.frequency.setValueAtTime(120, audioCtx.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(80, audioCtx.currentTime + 0.15);
            oscillator.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 0.3);

            oscillator.type = 'sawtooth';

            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);

            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.4);
        }

        // ============ SPEECH ============
        function speakWord(word) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(word);
                utterance.rate = 0.8;
                utterance.pitch = 1.1;
                window.speechSynthesis.speak(utterance);
            }
        }

        // ============ NAVIGATION ============
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');

            if (screenId === 'sight') initSightWords();
            if (screenId === 'spell') initSpelling();
            if (screenId === 'write') initWriting();
            if (screenId === 'match') newMatchGame();
            if (screenId === 'sentence') initSentence();
            if (screenId === 'vocab') initVocab();
        }

        function celebrate(emoji = 'ğŸ’©') {
            totalStars++;
            document.getElementById('totalStars').textContent = `Toots: ${totalStars} ğŸ’©`;

            // Play the toot sound!
            playToot();

            const cel = document.createElement('div');
            cel.className = 'celebration';
            cel.textContent = 'ğŸ’©';
            document.body.appendChild(cel);
            setTimeout(() => cel.remove(), 1000);
        }

        // ============ SIGHT WORDS ============
        function initSightWords() {
            sightIndex = 0;
            // Shuffle words when entering the section
            shuffledWarmupWords = shuffle(warmupWords);
            shuffledAdvancedWords = shuffle(advancedSightWords);
            showSightWord();
        }

        function setSightMode(mode) {
            sightMode = mode;
            sightIndex = 0;
            // Re-shuffle when switching modes
            if (mode === 'warmup') {
                shuffledWarmupWords = shuffle(warmupWords);
            } else {
                shuffledAdvancedWords = shuffle(advancedSightWords);
            }
            document.getElementById('warmupTab').classList.toggle('active', mode === 'warmup');
            document.getElementById('advancedTab').classList.toggle('active', mode === 'advanced');
            document.getElementById('warmupComplete').style.display = 'none';
            showSightWord();
        }

        function showSightWord() {
            const wordEl = document.getElementById('sightWord');
            const sentenceEl = document.getElementById('sightSentence');

            if (sightMode === 'warmup') {
                if (sightIndex >= shuffledWarmupWords.length) {
                    document.getElementById('warmupComplete').style.display = 'block';
                    sightIndex = shuffledWarmupWords.length - 1;
                }
                wordEl.textContent = shuffledWarmupWords[sightIndex];
                sentenceEl.textContent = '';
            } else {
                if (sightIndex >= shuffledAdvancedWords.length) sightIndex = 0;
                if (sightIndex < 0) sightIndex = shuffledAdvancedWords.length - 1;
                wordEl.textContent = shuffledAdvancedWords[sightIndex].word;
                sentenceEl.textContent = `"${shuffledAdvancedWords[sightIndex].sentence}"`;
            }
        }

        function nextSightWord() {
            sightIndex++;
            showSightWord();
        }

        function prevSightWord() {
            sightIndex--;
            if (sightIndex < 0) sightIndex = 0;
            showSightWord();
        }

        // ============ SPELLING ============
        function initSpelling() {
            spellIndex = 0;
            spellCorrect = 0;
            // Shuffle all difficulty levels
            shuffledSpellWords.easy = shuffle(spellingWords.easy);
            shuffledSpellWords.medium = shuffle(spellingWords.medium);
            shuffledSpellWords.hard = shuffle(spellingWords.hard);
            document.getElementById('spellScore').textContent = `Correct: ${spellCorrect}`;
            nextSpellWord();
        }

        function setDifficulty(diff) {
            spellDifficulty = diff;
            document.querySelectorAll('.diff-btn').forEach(btn => {
                btn.classList.toggle('active', btn.textContent.toLowerCase() === diff);
            });
            spellIndex = 0;
            // Re-shuffle when changing difficulty
            shuffledSpellWords[diff] = shuffle(spellingWords[diff]);
            nextSpellWord();
        }

        function nextSpellWord() {
            const words = shuffledSpellWords[spellDifficulty];
            if (spellIndex >= words.length) spellIndex = 0;
            currentSpellWord = words[spellIndex];
            spellIndex++;

            document.getElementById('spellInput').value = '';
            document.getElementById('spellFeedback').style.display = 'none';
            document.getElementById('spellNextBtn').style.display = 'none';
            document.getElementById('spellInput').focus();

            setTimeout(() => speakWord(currentSpellWord), 300);
        }

        function speakCurrentSpellWord() {
            speakWord(currentSpellWord);
        }

        function showHint() {
            const input = document.getElementById('spellInput');
            if (input.value.length === 0) {
                input.value = currentSpellWord[0];
            } else {
                // Show next letter hint
                const len = input.value.length;
                if (len < currentSpellWord.length) {
                    input.value = currentSpellWord.substring(0, len + 1);
                }
            }
            input.focus();
        }

        function checkSpelling() {
            const input = document.getElementById('spellInput').value.trim().toLowerCase();
            const feedback = document.getElementById('spellFeedback');

            if (input === currentSpellWord.toLowerCase()) {
                feedback.textContent = 'ğŸ‰ Correct! Great job!';
                feedback.className = 'feedback correct';
                spellCorrect++;
                document.getElementById('spellScore').textContent = `Correct: ${spellCorrect}`;
                celebrate('ğŸŒŸ');
            } else {
                feedback.textContent = `Try again! The word was: ${currentSpellWord}`;
                feedback.className = 'feedback incorrect';
            }

            feedback.style.display = 'block';
            document.getElementById('spellNextBtn').style.display = 'flex';
        }

        function checkSpellEnter(e) {
            if (e.key === 'Enter') checkSpelling();
        }

        // ============ HANDWRITING ============
        let canvas, ctx, isDrawing = false;

        function initWriting() {
            canvas = document.getElementById('writeCanvas');
            ctx = canvas.getContext('2d');
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 4;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';

            canvas.addEventListener('mousedown', startDraw);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDraw);
            canvas.addEventListener('mouseout', stopDraw);

            canvas.addEventListener('touchstart', handleTouch);
            canvas.addEventListener('touchmove', handleTouchMove);
            canvas.addEventListener('touchend', stopDraw);

            writeIndex = 0;
            // Shuffle writing words
            shuffledWriteWords = shuffle(writeWords);
            showWriteWord();
        }

        function handleTouch(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const rect = canvas.getBoundingClientRect();
            startDraw({ offsetX: touch.clientX - rect.left, offsetY: touch.clientY - rect.top });
        }

        function handleTouchMove(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const rect = canvas.getBoundingClientRect();
            draw({ offsetX: touch.clientX - rect.left, offsetY: touch.clientY - rect.top });
        }

        function startDraw(e) {
            isDrawing = true;
            ctx.beginPath();
            ctx.moveTo(e.offsetX, e.offsetY);
        }

        function draw(e) {
            if (!isDrawing) return;
            ctx.lineTo(e.offsetX, e.offsetY);
            ctx.stroke();
        }

        function stopDraw() {
            isDrawing = false;
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            if (writeMode === 'trace') showTraceGuide();
        }

        function setWriteMode(mode) {
            writeMode = mode;
            document.getElementById('freewriteTab').classList.toggle('active', mode === 'free');
            document.getElementById('traceTab').classList.toggle('active', mode === 'trace');

            const traceGuide = document.getElementById('traceGuide');
            if (mode === 'trace') {
                traceGuide.style.display = 'block';
                showTraceGuide();
            } else {
                traceGuide.style.display = 'none';
                clearCanvas();
            }
        }

        function showTraceGuide() {
            const word = document.getElementById('writeWord').textContent;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.save();
            ctx.font = '120px Comic Sans MS, cursive';
            ctx.fillStyle = '#e0e0e0';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(word, canvas.width / 2, canvas.height / 2);
            ctx.restore();
        }

        function showWriteWord() {
            if (writeIndex >= shuffledWriteWords.length) writeIndex = 0;
            document.getElementById('writeWord').textContent = shuffledWriteWords[writeIndex];
            document.getElementById('traceGuide').textContent = shuffledWriteWords[writeIndex];
            clearCanvas();
        }

        function nextWriteWord() {
            writeIndex++;
            showWriteWord();
            celebrate('âœï¸');
        }

        // ============ MATCHING ============
        function newMatchGame() {
            matchSelected = null;
            matchesFound = 0;
            document.getElementById('matchScore').textContent = 'Matches: 0 / 4';

            // Pick 4 random items
            const shuffled = [...matchItems].sort(() => Math.random() - 0.5);
            currentMatchItems = shuffled.slice(0, 4);

            // Render words
            const wordsEl = document.getElementById('matchWords');
            const shuffledWords = [...currentMatchItems].sort(() => Math.random() - 0.5);
            wordsEl.innerHTML = shuffledWords.map((item, i) =>
                `<div class="match-item" data-word="${item.word}" onclick="selectMatch(this, 'word')">${item.word}</div>`
            ).join('');

            // Render pictures
            const picsEl = document.getElementById('matchPictures');
            const shuffledPics = [...currentMatchItems].sort(() => Math.random() - 0.5);
            picsEl.innerHTML = shuffledPics.map((item, i) =>
                `<div class="match-item" data-word="${item.word}" onclick="selectMatch(this, 'pic')">${item.emoji}</div>`
            ).join('');
        }

        function selectMatch(el, type) {
            if (el.classList.contains('matched')) return;

            if (!matchSelected) {
                matchSelected = { el, type, word: el.dataset.word };
                el.classList.add('selected');
            } else {
                if (matchSelected.type !== type && matchSelected.word === el.dataset.word) {
                    // Match!
                    matchSelected.el.classList.remove('selected');
                    matchSelected.el.classList.add('matched');
                    el.classList.add('matched');
                    matchesFound++;
                    document.getElementById('matchScore').textContent = `Matches: ${matchesFound} / 4`;
                    celebrate('ğŸ¯');
                    speakWord(el.dataset.word);
                } else {
                    matchSelected.el.classList.remove('selected');
                }
                matchSelected = null;
            }
        }

        // ============ SENTENCE BUILDING ============
        function initSentence() {
            sentenceIndex = 0;
            // Shuffle sentences
            shuffledSentences = shuffle(sentences);
            loadSentence();
        }

        function loadSentence() {
            if (sentenceIndex >= shuffledSentences.length) sentenceIndex = 0;
            currentSentenceWords = [...shuffledSentences[sentenceIndex]];
            builtSentence = [];

            document.getElementById('sentenceFeedback').style.display = 'none';
            document.getElementById('sentenceNextBtn').style.display = 'none';
            document.getElementById('sentenceArea').innerHTML = '<span style="color:#999;">Click words below to add them here</span>';

            // Shuffle and render word bank
            const shuffled = currentSentenceWords.filter(w => w !== '.').sort(() => Math.random() - 0.5);
            document.getElementById('wordBank').innerHTML = shuffled.map(word =>
                `<div class="draggable-word" onclick="addToSentence(this)">${word}</div>`
            ).join('');
        }

        function addToSentence(el) {
            if (el.classList.contains('in-sentence')) {
                // Remove from sentence
                el.classList.remove('in-sentence');
                builtSentence = builtSentence.filter(w => w !== el.textContent);
            } else {
                el.classList.add('in-sentence');
                builtSentence.push(el.textContent);
            }

            updateSentenceDisplay();
        }

        function updateSentenceDisplay() {
            const area = document.getElementById('sentenceArea');
            if (builtSentence.length === 0) {
                area.innerHTML = '<span style="color:#999;">Click words below to add them here</span>';
            } else {
                area.innerHTML = builtSentence.map(w =>
                    `<span class="draggable-word in-sentence">${w}</span>`
                ).join(' ') + ' .';
            }
        }

        function clearSentence() {
            builtSentence = [];
            document.querySelectorAll('.draggable-word').forEach(el => el.classList.remove('in-sentence'));
            updateSentenceDisplay();
        }

        function checkSentence() {
            const correct = currentSentenceWords.filter(w => w !== '.').join(' ');
            const attempt = builtSentence.join(' ');
            const feedback = document.getElementById('sentenceFeedback');

            if (attempt === correct) {
                feedback.textContent = 'ğŸ‰ Perfect sentence!';
                feedback.className = 'feedback correct';
                celebrate('ğŸ“');
                speakWord(correct);
            } else {
                feedback.textContent = `Not quite. The sentence is: "${correct}."`;
                feedback.className = 'feedback incorrect';
            }

            feedback.style.display = 'block';
            document.getElementById('sentenceNextBtn').style.display = 'flex';
        }

        function nextSentence() {
            sentenceIndex++;
            loadSentence();
        }

        // ============ VOCABULARY ============
        function initVocab() {
            vocabMode = 'learn';
            currentCategory = null;
            challengeGuesses = [];

            document.getElementById('learnTab').classList.add('active');
            document.getElementById('challengeTab').classList.remove('active');

            showCategorySelect();
            renderCategories();
        }

        function setVocabMode(mode) {
            vocabMode = mode;
            document.getElementById('learnTab').classList.toggle('active', mode === 'learn');
            document.getElementById('challengeTab').classList.toggle('active', mode === 'challenge');

            if (currentCategory) {
                if (mode === 'learn') showLearnMode();
                else showChallengeMode();
            }
        }

        function renderCategories() {
            const grid = document.getElementById('categoryGrid');
            grid.innerHTML = Object.entries(vocabCategories).map(([key, cat]) =>
                `<button class="category-btn" onclick="selectCategory('${key}')">${cat.emoji} ${cat.name}</button>`
            ).join('');
        }

        function showCategorySelect() {
            document.getElementById('categorySelect').style.display = 'block';
            document.getElementById('learnMode').style.display = 'none';
            document.getElementById('challengeMode').style.display = 'none';
            document.getElementById('resultsMode').style.display = 'none';
        }

        function selectCategory(key) {
            currentCategory = key;
            challengeGuesses = [];

            if (vocabMode === 'learn') showLearnMode();
            else showChallengeMode();
        }

        function showLearnMode() {
            document.getElementById('categorySelect').style.display = 'none';
            document.getElementById('learnMode').style.display = 'block';
            document.getElementById('challengeMode').style.display = 'none';
            document.getElementById('resultsMode').style.display = 'none';

            const cat = vocabCategories[currentCategory];
            document.getElementById('learnCategoryTitle').textContent = `${cat.emoji} ${cat.name}`;

            document.getElementById('vocabList').innerHTML = cat.items.map((item, index) =>
                `<div class="vocab-item" onclick="showFunFact('${currentCategory}', ${index})">
                    <span class="item-emoji">${item.emoji}</span>
                    ${item.name}
                </div>`
            ).join('');
        }

        function showFunFact(category, index) {
            const item = vocabCategories[category].items[index];
            speakWord(item.name);

            const fact = item.fact || `This is a ${item.name}!`;

            // Create overlay
            const overlay = document.createElement('div');
            overlay.className = 'fact-overlay';
            overlay.onclick = closeFunFact;

            // Create popup
            const popup = document.createElement('div');
            popup.className = 'fact-popup';
            popup.innerHTML = `
                <div class="fact-emoji">${item.emoji}</div>
                <div class="fact-name">${item.name}</div>
                <div class="fact-text">${fact}</div>
                <button onclick="closeFunFact()">Got it!</button>
            `;

            document.body.appendChild(overlay);
            document.body.appendChild(popup);
        }

        function closeFunFact() {
            const overlay = document.querySelector('.fact-overlay');
            const popup = document.querySelector('.fact-popup');
            if (overlay) overlay.remove();
            if (popup) popup.remove();
        }

        function showChallengeMode() {
            document.getElementById('categorySelect').style.display = 'none';
            document.getElementById('learnMode').style.display = 'none';
            document.getElementById('challengeMode').style.display = 'block';
            document.getElementById('resultsMode').style.display = 'none';

            const cat = vocabCategories[currentCategory];
            document.getElementById('challengeCategoryTitle').textContent = `Name as many ${cat.name} as you can!`;
            document.getElementById('challengeInput').value = '';
            document.getElementById('challengeScore').textContent = 'You\'ve named: 0';
            document.getElementById('guessedWords').innerHTML = '';
            challengeGuesses = [];
            document.getElementById('challengeInput').focus();
        }

        function checkChallengeEnter(e) {
            if (e.key === 'Enter') {
                const input = document.getElementById('challengeInput');
                const guess = input.value.trim().toLowerCase();

                if (guess && !challengeGuesses.includes(guess)) {
                    const cat = vocabCategories[currentCategory];
                    const match = cat.items.find(item =>
                        item.name.toLowerCase() === guess ||
                        item.name.toLowerCase().includes(guess) ||
                        guess.includes(item.name.toLowerCase())
                    );

                    if (match && !challengeGuesses.some(g =>
                        g === match.name.toLowerCase() ||
                        vocabCategories[currentCategory].items.find(i => i.name.toLowerCase() === g)?.name === match.name
                    )) {
                        challengeGuesses.push(match.name.toLowerCase());
                        document.getElementById('guessedWords').innerHTML = challengeGuesses.map(w =>
                            `<span class="guessed-word">${w}</span>`
                        ).join('');
                        document.getElementById('challengeScore').textContent = `You've named: ${challengeGuesses.length}`;
                        speakWord(match.name);
                    }
                }

                input.value = '';
            }
        }

        function finishChallenge() {
            document.getElementById('challengeMode').style.display = 'none';
            document.getElementById('resultsMode').style.display = 'block';

            const cat = vocabCategories[currentCategory];
            const total = cat.items.length;
            const got = challengeGuesses.length;

            document.getElementById('resultsTitle').textContent = `${cat.emoji} ${cat.name} Results`;
            document.getElementById('resultsSummary').textContent =
                `Great job! You named ${got} out of ${total} ${cat.name.toLowerCase()}! ${got >= total / 2 ? 'ğŸŒŸ' : 'Keep practicing!'}`;

            if (got >= 5) celebrate('ğŸ†');

            document.getElementById('resultsList').innerHTML = cat.items.map(item => {
                const gotIt = challengeGuesses.includes(item.name.toLowerCase());
                return `<div class="result-item ${gotIt ? 'got-it' : 'missed'}">${item.emoji} ${item.name}</div>`;
            }).join('');
        }

        function retryChallenge() {
            challengeGuesses = [];
            showChallengeMode();
        }

        function backToCategories() {
            currentCategory = null;
            showCategorySelect();
        }
    </script>
</body>
</html>
